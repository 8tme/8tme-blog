import{j as v}from"./jsx-runtime.CYXfivyR.js";import{r as x}from"./index.Wp2u197Z.js";import{g as $,a as tt,b as et,c as nt}from"./date.CeBf7uU2.js";import{c as rt,m as at,a as st,i as ot,r as it,b as ut,d as z,e as ct,f as lt,g as ft,s as mt,p as pt,V as dt,h as gt,j as yt,S as ht,H as St,v as I,k as vt,l as Et,n as At,G as xt}from"./SVGVisualElement.CBlbrLkY.js";function Vt(t,e,n){var r;if(typeof t=="string"){let a=document;n?((r=n[t])!==null&&r!==void 0||(n[t]=a.querySelectorAll(t)),t=n[t]):t=a.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}function Dt(t,e=100,n){const r=n({...t,keyframes:[0,e]}),a=Math.min(rt(r),at);return{type:"keyframes",ease:o=>r.next(a*o).value/e,duration:st(a)}}function N(t){return typeof t=="object"&&!Array.isArray(t)}function J(t,e,n,r){return typeof t=="string"&&N(e)?Vt(t,n,r):t instanceof NodeList?Array.from(t):Array.isArray(t)?t:[t]}function _(t,e,n,r){var a;return typeof e=="number"?e:e.startsWith("-")||e.startsWith("+")?Math.max(0,t+parseFloat(e)):e==="<"?n:(a=r.get(e))!==null&&a!==void 0?a:t}const Ot=(t,e,n)=>{const r=e-t;return((n-t)%r+r)%r+t};function bt(t,e){return ot(t)?t[Ot(0,t.length,e)]:t}function jt(t,e,n){for(let r=0;r<t.length;r++){const a=t[r];a.at>e&&a.at<n&&(it(t,a),r--)}}function Tt(t,e,n,r,a,o){jt(t,a,o);for(let s=0;s<e.length;s++)t.push({value:e[s],at:ut(a,o,r[s]),easing:bt(n,s)})}function Mt(t,e){return t.at===e.at?t.value===null?1:e.value===null?-1:0:t.at-e.at}const It="easeInOut";function wt(t,{defaultTransition:e={},...n}={},r,a){const o=e.duration||.3,s=new Map,l=new Map,g={},i=new Map;let E=0,u=0,M=0;for(let D=0;D<t.length;D++){const p=t[D];if(typeof p=="string"){i.set(p,u);continue}else if(!Array.isArray(p)){i.set(p.name,_(u,p.at,E,i));continue}let[V,d,f={}]=p;f.at!==void 0&&(u=_(u,f.at,E,i));let m=0;const O=(y,h,A,j=0,T=0)=>{const c=Ft(y),{delay:w=0,times:b=ct(c),type:F="keyframes",...X}=h;let{ease:Y=e.ease||"easeOut",duration:S}=h;const K=typeof w=="function"?w(j,T):w,P=c.length,L=lt(F)?F:a?.[F];if(P<=2&&L){let H=100;if(P===2&&Yt(c)){const Z=c[1]-c[0];H=Math.abs(Z)}const U={...X};S!==void 0&&(U.duration=mt(S));const W=Dt(U,H,L);Y=W.ease,S=W.duration}S??(S=o);const B=u+K,C=B+S;b.length===1&&b[0]===0&&(b[1]=1);const R=b.length-c.length;R>0&&ft(b,R),c.length===1&&c.unshift(null),Tt(A,c,Y,b,B,C),m=Math.max(K+S,m),M=Math.max(C,M)};if(z(V)){const y=k(V,l);O(d,f,q("default",y))}else{const y=J(V,d,r,g),h=y.length;for(let A=0;A<h;A++){d=d,f=f;const j=y[A],T=k(j,l);for(const c in d)O(d[c],Gt(f,c),q(c,T),A,h)}}E=u,u+=m}return l.forEach((D,p)=>{for(const V in D){const d=D[V];d.sort(Mt);const f=[],m=[],O=[];for(let h=0;h<d.length;h++){const{at:A,value:j,easing:T}=d[h];f.push(j),m.push(pt(0,M,A)),O.push(T||"easeOut")}m[0]!==0&&(m.unshift(0),f.unshift(f[0]),O.unshift(It)),m[m.length-1]!==1&&(m.push(1),f.push(null)),s.has(p)||s.set(p,{keyframes:{},transition:{}});const y=s.get(p);y.keyframes[V]=f,y.transition[V]={...e,duration:M,ease:O,times:m,...n}}}),s}function k(t,e){return!e.has(t)&&e.set(t,{}),e.get(t)}function q(t,e){return e[t]||(e[t]=[]),e[t]}function Ft(t){return Array.isArray(t)?t:[t]}function Gt(t,e){return t&&t[e]?{...t,...t[e]}:{...t}}const Nt=t=>typeof t=="number",Yt=t=>t.every(Nt);function Kt(t,e){return t in e}class Pt extends dt{constructor(){super(...arguments),this.type="object"}readValueFromInstance(e,n){if(Kt(n,e)){const r=e[n];if(typeof r=="string"||typeof r=="number")return r}}getBaseTargetFromProps(){}removeValueFromRenderState(e,n){delete n.output[e]}measureInstanceViewportBox(){return gt()}build(e,n){Object.assign(e.output,n)}renderInstance(e,{output:n}){Object.assign(e,n)}sortInstanceNodePosition(){return 0}}function Lt(t){const e={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},n=yt(t)?new ht(e):new St(e);n.mount(t),I.set(t,n)}function Bt(t){const e={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},n=new Pt(e);n.mount(t),I.set(t,n)}function Ct(t,e){return z(t)||typeof t=="number"||typeof t=="string"&&!N(e)}function Q(t,e,n,r){const a=[];if(Ct(t,e))a.push(vt(t,N(e)&&e.default||e,n&&(n.default||n)));else{const o=J(t,e,r),s=o.length;for(let l=0;l<s;l++){const g=o[l],i=g instanceof Element?Lt:Bt;I.has(g)||i(g);const E=I.get(g),u={...n};"delay"in u&&typeof u.delay=="function"&&(u.delay=u.delay(l,s)),a.push(...Et(E,{...e,transition:u},{}))}}return a}function Rt(t,e,n){const r=[];return wt(t,e,n,{spring:At}).forEach(({keyframes:o,transition:s},l)=>{r.push(...Q(l,o,s))}),r}function Ht(t){return Array.isArray(t)&&Array.isArray(t[0])}function Ut(t){function e(n,r,a){let o=[];return Ht(n)?o=Rt(n,r,t):o=Q(n,r,a,t),new xt(o)}return e}const Wt=Ut();function Jt(){const[t,e]=x.useState(0),[n,r]=x.useState(0),[a,o]=x.useState(0),[s,l]=x.useState(0),g=()=>{const i=new Date;e(i.getFullYear());const E=$(tt(i),i);r(E),o(E/et(i)*100);const u=i.getTime()-nt(i).getTime();l(u/86400/1e3*100)};return x.useEffect(()=>{g();const i=setInterval(g,1e3);return()=>{clearInterval(i)}},[]),v.jsxs(v.Fragment,{children:[v.jsxs("p",{className:"mt-4",children:["今天是 ",t," 年的第 ",v.jsx(G,{to:n,decimals:0})," 天"]}),v.jsxs("p",{className:"mt-4",children:["今年已过 ",v.jsx(G,{to:a,decimals:5}),"%"]}),v.jsxs("p",{className:"mt-4",children:["今天已过 ",v.jsx(G,{to:s,decimals:5}),"%"]})]})}function G({to:t,decimals:e,duration:n=1}){const r=x.useRef(null),a=x.useRef(0);return x.useEffect(()=>{if(!r.current)return;const o=Wt(a.current,t,{duration:n,onUpdate:s=>{r.current.textContent=s.toFixed(e)}});return a.current=t,()=>{o.stop()}},[t,e,n]),v.jsx("span",{ref:r})}export{Jt as TimelineProgress};
