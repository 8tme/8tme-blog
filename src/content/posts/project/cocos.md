---
title: COCOS 3D桌球游戏
date: 2024-07-02
summary: 记录了开发桌球游戏中遇到的坑
category: 项目
tags: [cocos,坑]
---

### Cocos Creator

1. 编辑器和 unity 的类似，坐标系的设定上略有差异
2. 编辑器上的模拟器预览准确度和可调试性上会比 chrome 浏览器高一点，在浏览器上，诸如桌球游戏中可能会出现检测到会发生碰撞，实际未发生碰撞的情况

### 3D问题记录

1. lookAt方法要在设置位置之前调用，否者结果可能会有误差。
2. 碰撞体设置不能跟其他物理物体重叠，否则会发生碰撞开始运动，初摩擦力过小、初始线性速度不为0
3. 线性因子，作用力作用在某一个轴上的效果，设置为0表示没效果
4. 要获取屏幕中某个位置的世界坐标，根据点击位置创建一条射线，使用射线检测碰撞点获取结果中的 hitPoint
5. 不同物理引擎实现的物理效果不同，根据需求选择，物理引擎 bug 比较多，物理效果和预想的有出入， 碰到击打贴边球不反弹垂直入袋的现象
6. physics同样有问题，比如现实中的中杆，在 physics 中可能哪些配置有问题，会出现被弹回的现象，同样的参数在 bullet 中表现则是正常的，具体跟参数的搭配有关系，但不知道具体如何调整
7. 物体大小基本上通过 scale 控制，内置的3D 组件的锚点都在中心位置
8. 碰撞组的设置可以优化性能，编辑器内可以设置碰撞矩阵，来控制不同碰撞体之间的碰撞关系
9. 3D球形设置了刚体之后无法发生滚动，需要自行添加角速度模拟
10. 碰撞体如果中心不为 0，碰撞现象会出现异常
11. 施加冲量在球正对我们的位置让小球运动的时候，在有摩擦力的情况下，球的运动方向会偏移预定轨迹
12. cocos 内置支持的各种物理引擎都不是定点数引擎，会导致在联网同步的时候不同步，当冲量也保留一定位数的时候，会导致瞄准的时候显示击中但实际未击中的情况
13. 碰撞体薄会无法检测高速运动的物体，出现穿模，即使打开 CCD 也没用，可以通过增大物理步长，提升计算精度的方式去提高碰撞检测到的概率，最简单的是增大碰撞体的厚度
14. 球入袋的效果可以通过手动增加球在垂直于平面的速度实现

